"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/upload/route";
exports.ids = ["app/api/upload/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=D%3A%5CStickerfly%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CStickerfly&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=D%3A%5CStickerfly%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CStickerfly&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Stickerfly_app_api_upload_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/upload/route.ts */ \"(rsc)/./app/api/upload/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/upload/route\",\n        pathname: \"/api/upload\",\n        filename: \"route\",\n        bundlePath: \"app/api/upload/route\"\n    },\n    resolvedPagePath: \"D:\\\\Stickerfly\\\\app\\\\api\\\\upload\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Stickerfly_app_api_upload_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/upload/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ1cGxvYWQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnVwbG9hZCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnVwbG9hZCUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDU3RpY2tlcmZseSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q1N0aWNrZXJmbHkmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ047QUFDdkU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdGlja2VyZmx5Lz8zOGRjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXFN0aWNrZXJmbHlcXFxcYXBwXFxcXGFwaVxcXFx1cGxvYWRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwic3RhbmRhbG9uZVwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS91cGxvYWQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS91cGxvYWRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3VwbG9hZC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXFN0aWNrZXJmbHlcXFxcYXBwXFxcXGFwaVxcXFx1cGxvYWRcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvdXBsb2FkL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=D%3A%5CStickerfly%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CStickerfly&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/upload/route.ts":
/*!*********************************!*\
  !*** ./app/api/upload/route.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var stream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! stream */ \"stream\");\n/* harmony import */ var stream__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(stream__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n\n// Force dynamic rendering\nconst dynamic = \"force-dynamic\";\n// Create uploads directory if it doesn't exist\nasync function ensureUploadDir() {\n    // Use absolute path to make sure we're writing to the correct location\n    const uploadDir = path__WEBPACK_IMPORTED_MODULE_4___default().resolve(process.cwd(), \"public\", \"uploads\");\n    console.log(`Upload directory absolute path: ${uploadDir}`);\n    try {\n        // Check if directory exists\n        if (!(0,fs__WEBPACK_IMPORTED_MODULE_2__.existsSync)(uploadDir)) {\n            console.log(`Creating upload directory: ${uploadDir}`);\n            await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.mkdir)(uploadDir, {\n                recursive: true\n            });\n        } else {\n            console.log(`Upload directory already exists: ${uploadDir}`);\n        }\n        return uploadDir;\n    } catch (error) {\n        console.error(\"Error creating upload directory:\", error);\n        throw error;\n    }\n}\n// Helper function to convert Buffer to Stream\nfunction bufferToStream(buffer) {\n    const readable = new stream__WEBPACK_IMPORTED_MODULE_3__.Readable();\n    readable._read = ()=>{}; // _read is required but you can noop it\n    readable.push(buffer);\n    readable.push(null);\n    return readable;\n}\n// Helper function to write file using streams\nfunction writeFileWithStream(filePath, buffer) {\n    return new Promise((resolve, reject)=>{\n        const stream = (0,fs__WEBPACK_IMPORTED_MODULE_2__.createWriteStream)(filePath);\n        const readable = bufferToStream(buffer);\n        stream.on(\"error\", (error)=>{\n            console.error(`Stream error writing to ${filePath}:`, error);\n            reject(error);\n        });\n        stream.on(\"finish\", ()=>{\n            console.log(`File successfully written to ${filePath} using stream`);\n            resolve();\n        });\n        readable.pipe(stream);\n    });\n}\n// Helper function to save file to temp directory first, then move to final location\nasync function saveFileThroughTemp(buffer, finalPath) {\n    try {\n        // Create a temporary file path in the OS temp directory\n        const tempDir = os__WEBPACK_IMPORTED_MODULE_5___default().tmpdir();\n        const tempFilename = `upload-${(0,uuid__WEBPACK_IMPORTED_MODULE_6__[\"default\"])()}`;\n        const tempPath = path__WEBPACK_IMPORTED_MODULE_4___default().join(tempDir, tempFilename);\n        console.log(`Saving to temporary location: ${tempPath}`);\n        // Write to temp location first\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(tempPath, buffer);\n        // Verify temp file was created\n        if (!(0,fs__WEBPACK_IMPORTED_MODULE_2__.existsSync)(tempPath)) {\n            throw new Error(`Failed to create temporary file at ${tempPath}`);\n        }\n        console.log(`Temporary file created successfully: ${tempPath}`);\n        // Copy from temp to final destination\n        console.log(`Copying from ${tempPath} to ${finalPath}`);\n        (0,fs__WEBPACK_IMPORTED_MODULE_2__.copyFileSync)(tempPath, finalPath);\n        // Verify final file exists\n        if (!(0,fs__WEBPACK_IMPORTED_MODULE_2__.existsSync)(finalPath)) {\n            throw new Error(`Failed to copy file to final destination: ${finalPath}`);\n        }\n        console.log(`File successfully saved to final destination: ${finalPath}`);\n    } catch (error) {\n        console.error(\"Error in saveFileThroughTemp:\", error);\n        throw error;\n    }\n}\nasync function POST(request) {\n    console.log(\"Upload request received\");\n    try {\n        // Remove session check to allow public uploads\n        // This is necessary for the custom order page where users might not be logged in\n        const formData = await request.formData();\n        const file = formData.get(\"file\");\n        if (!file) {\n            console.error(\"No file uploaded\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"No file uploaded\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(`File received: ${file.name}, type: ${file.type}, size: ${file.size} bytes`);\n        // Check file type\n        const allowedTypes = [\n            \"image/jpeg\",\n            \"image/png\",\n            \"image/svg+xml\"\n        ];\n        if (!allowedTypes.includes(file.type)) {\n            console.error(`Invalid file type: ${file.type}`);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"File type not supported. Please upload JPEG, PNG, or SVG.\"\n            }, {\n                status: 400\n            });\n        }\n        // Check file size (limit to 5MB)\n        if (file.size > 5 * 1024 * 1024) {\n            console.error(`File too large: ${file.size} bytes`);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"File size too large. Maximum size is 5MB.\"\n            }, {\n                status: 400\n            });\n        }\n        // Generate unique filename\n        const fileExtension = file.name.split(\".\").pop() || \"\";\n        const uniqueFilename = `${(0,uuid__WEBPACK_IMPORTED_MODULE_6__[\"default\"])()}.${fileExtension}`;\n        // Ensure upload directory exists\n        const uploadDir = await ensureUploadDir();\n        // File path where the image will be saved\n        const filePath = path__WEBPACK_IMPORTED_MODULE_4___default().resolve(uploadDir, uniqueFilename);\n        console.log(`Saving file to: ${filePath}`);\n        try {\n            // Convert file to buffer\n            const arrayBuffer = await file.arrayBuffer();\n            const buffer = Buffer.from(arrayBuffer);\n            // Try different methods to save the file\n            try {\n                // Try saving through temp file first (most reliable)\n                await saveFileThroughTemp(buffer, filePath);\n            } catch (tempError) {\n                console.error(\"Error with temp file method, trying direct write:\", tempError);\n                try {\n                    // Try direct write with fs.writeFile\n                    console.log(\"Attempting to write file using fs.writeFile...\");\n                    await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(filePath, buffer);\n                    console.log(\"File successfully written using fs.writeFile\");\n                } catch (writeError) {\n                    console.error(\"Error with fs.writeFile, trying stream method:\", writeError);\n                    await writeFileWithStream(filePath, buffer);\n                }\n            }\n            // Verify the file was created\n            if (!(0,fs__WEBPACK_IMPORTED_MODULE_2__.existsSync)(filePath)) {\n                throw new Error(`File was not created at ${filePath}`);\n            }\n            console.log(`File successfully written to disk: ${filePath}`);\n            // Public URL for the uploaded file\n            const publicUrl = `/uploads/${uniqueFilename}`;\n            console.log(`Public URL: ${publicUrl}`);\n            // Return the URL to the uploaded file\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                url: publicUrl,\n                public_id: uniqueFilename\n            });\n        } catch (writeError) {\n            console.error(\"Error writing file to disk:\", writeError);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Failed to save uploaded file to disk\",\n                details: writeError instanceof Error ? writeError.message : \"Unknown error\",\n                path: filePath\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Error processing upload:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to upload file\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVMsQ0FBQztZQUN2RDtZQUVBVixRQUFRQyxHQUFHLENBQUMsQ0FBQyxtQ0FBbUMsRUFBRVMsU0FBUyxDQUFDO1lBRTVELG1DQUFtQztZQUNuQyxNQUFNbUMsWUFBWSxDQUFDLFNBQVMsRUFBRU4sZUFBZSxDQUFDO1lBQzlDdkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsWUFBWSxFQUFFNEMsVUFBVSxDQUFDO1lBRXRDLHNDQUFzQztZQUN0QyxPQUFPOUQsa0ZBQVlBLENBQUM4QyxJQUFJLENBQUM7Z0JBQ3ZCaUIsS0FBS0Q7Z0JBQ0xFLFdBQVdSO1lBQ2I7UUFDRixFQUFFLE9BQU9LLFlBQVk7WUFDbkI1QyxRQUFRRyxLQUFLLENBQUMsK0JBQStCeUM7WUFDN0MsT0FBTzdELGtGQUFZQSxDQUFDOEMsSUFBSSxDQUN0QjtnQkFDRTFCLE9BQU87Z0JBQ1A2QyxTQUFTSixzQkFBc0JyQixRQUFRcUIsV0FBV0ssT0FBTyxHQUFHO2dCQUM1RHpELE1BQU1rQjtZQUNSLEdBQ0E7Z0JBQUVvQixRQUFRO1lBQUk7UUFFbEI7SUFDRixFQUFFLE9BQU8zQixPQUFPO1FBQ2RILFFBQVFHLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE9BQU9wQixrRkFBWUEsQ0FBQzhDLElBQUksQ0FDdEI7WUFDRTFCLE9BQU87WUFDUDZDLFNBQVM3QyxpQkFBaUJvQixRQUFRcEIsTUFBTThDLE9BQU8sR0FBRztRQUNwRCxHQUNBO1lBQUVuQixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0aWNrZXJmbHkvLi9hcHAvYXBpL3VwbG9hZC9yb3V0ZS50cz9hODhkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgd3JpdGVGaWxlLCBta2RpciB9IGZyb20gJ2ZzL3Byb21pc2VzJztcclxuaW1wb3J0IHsgam9pbiB9IGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcclxuaW1wb3J0IHsgZXhpc3RzU3luYywgY3JlYXRlV3JpdGVTdHJlYW0sIGNvcHlGaWxlU3luYyB9IGZyb20gJ2ZzJztcclxuaW1wb3J0IHsgUmVhZGFibGUgfSBmcm9tICdzdHJlYW0nO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IG9zIGZyb20gJ29zJztcclxuXHJcbi8vIEZvcmNlIGR5bmFtaWMgcmVuZGVyaW5nXHJcbmV4cG9ydCBjb25zdCBkeW5hbWljID0gJ2ZvcmNlLWR5bmFtaWMnO1xyXG5cclxuLy8gQ3JlYXRlIHVwbG9hZHMgZGlyZWN0b3J5IGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuYXN5bmMgZnVuY3Rpb24gZW5zdXJlVXBsb2FkRGlyKCkge1xyXG4gIC8vIFVzZSBhYnNvbHV0ZSBwYXRoIHRvIG1ha2Ugc3VyZSB3ZSdyZSB3cml0aW5nIHRvIHRoZSBjb3JyZWN0IGxvY2F0aW9uXHJcbiAgY29uc3QgdXBsb2FkRGlyID0gcGF0aC5yZXNvbHZlKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCAndXBsb2FkcycpO1xyXG4gIGNvbnNvbGUubG9nKGBVcGxvYWQgZGlyZWN0b3J5IGFic29sdXRlIHBhdGg6ICR7dXBsb2FkRGlyfWApO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyBDaGVjayBpZiBkaXJlY3RvcnkgZXhpc3RzXHJcbiAgICBpZiAoIWV4aXN0c1N5bmModXBsb2FkRGlyKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgQ3JlYXRpbmcgdXBsb2FkIGRpcmVjdG9yeTogJHt1cGxvYWREaXJ9YCk7XHJcbiAgICAgIGF3YWl0IG1rZGlyKHVwbG9hZERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZyhgVXBsb2FkIGRpcmVjdG9yeSBhbHJlYWR5IGV4aXN0czogJHt1cGxvYWREaXJ9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdXBsb2FkRGlyO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyB1cGxvYWQgZGlyZWN0b3J5OicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgQnVmZmVyIHRvIFN0cmVhbVxyXG5mdW5jdGlvbiBidWZmZXJUb1N0cmVhbShidWZmZXI6IEJ1ZmZlcikge1xyXG4gIGNvbnN0IHJlYWRhYmxlID0gbmV3IFJlYWRhYmxlKCk7XHJcbiAgcmVhZGFibGUuX3JlYWQgPSAoKSA9PiB7fTsgLy8gX3JlYWQgaXMgcmVxdWlyZWQgYnV0IHlvdSBjYW4gbm9vcCBpdFxyXG4gIHJlYWRhYmxlLnB1c2goYnVmZmVyKTtcclxuICByZWFkYWJsZS5wdXNoKG51bGwpO1xyXG4gIHJldHVybiByZWFkYWJsZTtcclxufVxyXG5cclxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHdyaXRlIGZpbGUgdXNpbmcgc3RyZWFtc1xyXG5mdW5jdGlvbiB3cml0ZUZpbGVXaXRoU3RyZWFtKGZpbGVQYXRoOiBzdHJpbmcsIGJ1ZmZlcjogQnVmZmVyKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHN0cmVhbSA9IGNyZWF0ZVdyaXRlU3RyZWFtKGZpbGVQYXRoKTtcclxuICAgIGNvbnN0IHJlYWRhYmxlID0gYnVmZmVyVG9TdHJlYW0oYnVmZmVyKTtcclxuICAgIFxyXG4gICAgc3RyZWFtLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBTdHJlYW0gZXJyb3Igd3JpdGluZyB0byAke2ZpbGVQYXRofTpgLCBlcnJvcik7XHJcbiAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgc3RyZWFtLm9uKCdmaW5pc2gnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBGaWxlIHN1Y2Nlc3NmdWxseSB3cml0dGVuIHRvICR7ZmlsZVBhdGh9IHVzaW5nIHN0cmVhbWApO1xyXG4gICAgICByZXNvbHZlKCk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmVhZGFibGUucGlwZShzdHJlYW0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gc2F2ZSBmaWxlIHRvIHRlbXAgZGlyZWN0b3J5IGZpcnN0LCB0aGVuIG1vdmUgdG8gZmluYWwgbG9jYXRpb25cclxuYXN5bmMgZnVuY3Rpb24gc2F2ZUZpbGVUaHJvdWdoVGVtcChidWZmZXI6IEJ1ZmZlciwgZmluYWxQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgLy8gQ3JlYXRlIGEgdGVtcG9yYXJ5IGZpbGUgcGF0aCBpbiB0aGUgT1MgdGVtcCBkaXJlY3RvcnlcclxuICAgIGNvbnN0IHRlbXBEaXIgPSBvcy50bXBkaXIoKTtcclxuICAgIGNvbnN0IHRlbXBGaWxlbmFtZSA9IGB1cGxvYWQtJHt1dWlkdjQoKX1gO1xyXG4gICAgY29uc3QgdGVtcFBhdGggPSBwYXRoLmpvaW4odGVtcERpciwgdGVtcEZpbGVuYW1lKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFNhdmluZyB0byB0ZW1wb3JhcnkgbG9jYXRpb246ICR7dGVtcFBhdGh9YCk7XHJcbiAgICBcclxuICAgIC8vIFdyaXRlIHRvIHRlbXAgbG9jYXRpb24gZmlyc3RcclxuICAgIGF3YWl0IHdyaXRlRmlsZSh0ZW1wUGF0aCwgYnVmZmVyKTtcclxuICAgIFxyXG4gICAgLy8gVmVyaWZ5IHRlbXAgZmlsZSB3YXMgY3JlYXRlZFxyXG4gICAgaWYgKCFleGlzdHNTeW5jKHRlbXBQYXRoKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgdGVtcG9yYXJ5IGZpbGUgYXQgJHt0ZW1wUGF0aH1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFRlbXBvcmFyeSBmaWxlIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5OiAke3RlbXBQYXRofWApO1xyXG4gICAgXHJcbiAgICAvLyBDb3B5IGZyb20gdGVtcCB0byBmaW5hbCBkZXN0aW5hdGlvblxyXG4gICAgY29uc29sZS5sb2coYENvcHlpbmcgZnJvbSAke3RlbXBQYXRofSB0byAke2ZpbmFsUGF0aH1gKTtcclxuICAgIGNvcHlGaWxlU3luYyh0ZW1wUGF0aCwgZmluYWxQYXRoKTtcclxuICAgIFxyXG4gICAgLy8gVmVyaWZ5IGZpbmFsIGZpbGUgZXhpc3RzXHJcbiAgICBpZiAoIWV4aXN0c1N5bmMoZmluYWxQYXRoKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjb3B5IGZpbGUgdG8gZmluYWwgZGVzdGluYXRpb246ICR7ZmluYWxQYXRofWApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgRmlsZSBzdWNjZXNzZnVsbHkgc2F2ZWQgdG8gZmluYWwgZGVzdGluYXRpb246ICR7ZmluYWxQYXRofWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzYXZlRmlsZVRocm91Z2hUZW1wOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xyXG4gIGNvbnNvbGUubG9nKCdVcGxvYWQgcmVxdWVzdCByZWNlaXZlZCcpO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyBSZW1vdmUgc2Vzc2lvbiBjaGVjayB0byBhbGxvdyBwdWJsaWMgdXBsb2Fkc1xyXG4gICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgZm9yIHRoZSBjdXN0b20gb3JkZXIgcGFnZSB3aGVyZSB1c2VycyBtaWdodCBub3QgYmUgbG9nZ2VkIGluXHJcblxyXG4gICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXF1ZXN0LmZvcm1EYXRhKCk7XHJcbiAgICBjb25zdCBmaWxlID0gZm9ybURhdGEuZ2V0KCdmaWxlJykgYXMgRmlsZTtcclxuXHJcbiAgICBpZiAoIWZpbGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignTm8gZmlsZSB1cGxvYWRlZCcpO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ05vIGZpbGUgdXBsb2FkZWQnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYEZpbGUgcmVjZWl2ZWQ6ICR7ZmlsZS5uYW1lfSwgdHlwZTogJHtmaWxlLnR5cGV9LCBzaXplOiAke2ZpbGUuc2l6ZX0gYnl0ZXNgKTtcclxuXHJcbiAgICAvLyBDaGVjayBmaWxlIHR5cGVcclxuICAgIGNvbnN0IGFsbG93ZWRUeXBlcyA9IFsnaW1hZ2UvanBlZycsICdpbWFnZS9wbmcnLCAnaW1hZ2Uvc3ZnK3htbCddO1xyXG4gICAgaWYgKCFhbGxvd2VkVHlwZXMuaW5jbHVkZXMoZmlsZS50eXBlKSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBJbnZhbGlkIGZpbGUgdHlwZTogJHtmaWxlLnR5cGV9YCk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnRmlsZSB0eXBlIG5vdCBzdXBwb3J0ZWQuIFBsZWFzZSB1cGxvYWQgSlBFRywgUE5HLCBvciBTVkcuJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZpbGUgc2l6ZSAobGltaXQgdG8gNU1CKVxyXG4gICAgaWYgKGZpbGUuc2l6ZSA+IDUgKiAxMDI0ICogMTAyNCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBGaWxlIHRvbyBsYXJnZTogJHtmaWxlLnNpemV9IGJ5dGVzYCk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnRmlsZSBzaXplIHRvbyBsYXJnZS4gTWF4aW11bSBzaXplIGlzIDVNQi4nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgdW5pcXVlIGZpbGVuYW1lXHJcbiAgICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCkgfHwgJyc7XHJcbiAgICBjb25zdCB1bmlxdWVGaWxlbmFtZSA9IGAke3V1aWR2NCgpfS4ke2ZpbGVFeHRlbnNpb259YDtcclxuICAgIFxyXG4gICAgLy8gRW5zdXJlIHVwbG9hZCBkaXJlY3RvcnkgZXhpc3RzXHJcbiAgICBjb25zdCB1cGxvYWREaXIgPSBhd2FpdCBlbnN1cmVVcGxvYWREaXIoKTtcclxuICAgIFxyXG4gICAgLy8gRmlsZSBwYXRoIHdoZXJlIHRoZSBpbWFnZSB3aWxsIGJlIHNhdmVkXHJcbiAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGgucmVzb2x2ZSh1cGxvYWREaXIsIHVuaXF1ZUZpbGVuYW1lKTtcclxuICAgIGNvbnNvbGUubG9nKGBTYXZpbmcgZmlsZSB0bzogJHtmaWxlUGF0aH1gKTtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQ29udmVydCBmaWxlIHRvIGJ1ZmZlclxyXG4gICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKTtcclxuICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYXJyYXlCdWZmZXIpO1xyXG4gICAgICBcclxuICAgICAgLy8gVHJ5IGRpZmZlcmVudCBtZXRob2RzIHRvIHNhdmUgdGhlIGZpbGVcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBUcnkgc2F2aW5nIHRocm91Z2ggdGVtcCBmaWxlIGZpcnN0IChtb3N0IHJlbGlhYmxlKVxyXG4gICAgICAgIGF3YWl0IHNhdmVGaWxlVGhyb3VnaFRlbXAoYnVmZmVyLCBmaWxlUGF0aCk7XHJcbiAgICAgIH0gY2F0Y2ggKHRlbXBFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHdpdGggdGVtcCBmaWxlIG1ldGhvZCwgdHJ5aW5nIGRpcmVjdCB3cml0ZTonLCB0ZW1wRXJyb3IpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBUcnkgZGlyZWN0IHdyaXRlIHdpdGggZnMud3JpdGVGaWxlXHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnQXR0ZW1wdGluZyB0byB3cml0ZSBmaWxlIHVzaW5nIGZzLndyaXRlRmlsZS4uLicpO1xyXG4gICAgICAgICAgYXdhaXQgd3JpdGVGaWxlKGZpbGVQYXRoLCBidWZmZXIpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgc3VjY2Vzc2Z1bGx5IHdyaXR0ZW4gdXNpbmcgZnMud3JpdGVGaWxlJyk7XHJcbiAgICAgICAgfSBjYXRjaCAod3JpdGVFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igd2l0aCBmcy53cml0ZUZpbGUsIHRyeWluZyBzdHJlYW0gbWV0aG9kOicsIHdyaXRlRXJyb3IpO1xyXG4gICAgICAgICAgYXdhaXQgd3JpdGVGaWxlV2l0aFN0cmVhbShmaWxlUGF0aCwgYnVmZmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFZlcmlmeSB0aGUgZmlsZSB3YXMgY3JlYXRlZFxyXG4gICAgICBpZiAoIWV4aXN0c1N5bmMoZmlsZVBhdGgpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlIHdhcyBub3QgY3JlYXRlZCBhdCAke2ZpbGVQYXRofWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZyhgRmlsZSBzdWNjZXNzZnVsbHkgd3JpdHRlbiB0byBkaXNrOiAke2ZpbGVQYXRofWApO1xyXG4gICAgICBcclxuICAgICAgLy8gUHVibGljIFVSTCBmb3IgdGhlIHVwbG9hZGVkIGZpbGVcclxuICAgICAgY29uc3QgcHVibGljVXJsID0gYC91cGxvYWRzLyR7dW5pcXVlRmlsZW5hbWV9YDtcclxuICAgICAgY29uc29sZS5sb2coYFB1YmxpYyBVUkw6ICR7cHVibGljVXJsfWApO1xyXG5cclxuICAgICAgLy8gUmV0dXJuIHRoZSBVUkwgdG8gdGhlIHVwbG9hZGVkIGZpbGVcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICB1cmw6IHB1YmxpY1VybCxcclxuICAgICAgICBwdWJsaWNfaWQ6IHVuaXF1ZUZpbGVuYW1lLFxyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKHdyaXRlRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igd3JpdGluZyBmaWxlIHRvIGRpc2s6Jywgd3JpdGVFcnJvcik7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gc2F2ZSB1cGxvYWRlZCBmaWxlIHRvIGRpc2snLFxyXG4gICAgICAgICAgZGV0YWlsczogd3JpdGVFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gd3JpdGVFcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxyXG4gICAgICAgICAgcGF0aDogZmlsZVBhdGhcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIHVwbG9hZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgXHJcbiAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gdXBsb2FkIGZpbGUnLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIndyaXRlRmlsZSIsIm1rZGlyIiwidjQiLCJ1dWlkdjQiLCJleGlzdHNTeW5jIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJjb3B5RmlsZVN5bmMiLCJSZWFkYWJsZSIsInBhdGgiLCJvcyIsImR5bmFtaWMiLCJlbnN1cmVVcGxvYWREaXIiLCJ1cGxvYWREaXIiLCJyZXNvbHZlIiwicHJvY2VzcyIsImN3ZCIsImNvbnNvbGUiLCJsb2ciLCJyZWN1cnNpdmUiLCJlcnJvciIsImJ1ZmZlclRvU3RyZWFtIiwiYnVmZmVyIiwicmVhZGFibGUiLCJfcmVhZCIsInB1c2giLCJ3cml0ZUZpbGVXaXRoU3RyZWFtIiwiZmlsZVBhdGgiLCJQcm9taXNlIiwicmVqZWN0Iiwic3RyZWFtIiwib24iLCJwaXBlIiwic2F2ZUZpbGVUaHJvdWdoVGVtcCIsImZpbmFsUGF0aCIsInRlbXBEaXIiLCJ0bXBkaXIiLCJ0ZW1wRmlsZW5hbWUiLCJ0ZW1wUGF0aCIsImpvaW4iLCJFcnJvciIsIlBPU1QiLCJyZXF1ZXN0IiwiZm9ybURhdGEiLCJmaWxlIiwiZ2V0IiwianNvbiIsInN0YXR1cyIsIm5hbWUiLCJ0eXBlIiwic2l6ZSIsImFsbG93ZWRUeXBlcyIsImluY2x1ZGVzIiwiZmlsZUV4dGVuc2lvbiIsInNwbGl0IiwicG9wIiwidW5pcXVlRmlsZW5hbWUiLCJhcnJheUJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJ0ZW1wRXJyb3IiLCJ3cml0ZUVycm9yIiwicHVibGljVXJsIiwidXJsIiwicHVibGljX2lkIiwiZGV0YWlscyIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/upload/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=D%3A%5CStickerfly%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CStickerfly&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();